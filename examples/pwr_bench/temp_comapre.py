# coolant temperature is specified in 'results for channel' tables
# and in 'results for rod' tables. Here I compare them for a_scf_1 case.
chT = {}
chR = {}
rod = {}
chT[1]  = [  286.85, 287.57, 288.81, 292.12, 297.13, 306.96, 315.01, 319.95, 322.12, 323.21, 323.29, 323.32]
chT[2]  = [  286.85, 287.65, 288.91, 292.18, 297.22, 307.12, 315.03, 319.96, 322.06, 323.05, 323.16, 323.20]
chT[3]  = [  286.85, 287.65, 288.89, 292.24, 297.50, 307.35, 315.14, 320.15, 322.19, 323.08, 323.19, 323.23]
chT[19] = [  286.85, 287.61, 288.73, 291.97, 297.12, 307.05, 315.14, 320.10, 322.17, 323.27, 323.40, 323.44]
chT[20] = [  286.85, 287.67, 288.82, 292.11, 297.31, 307.19, 315.14, 320.11, 322.12, 323.11, 323.26, 323.31]
chT[21] = [  286.85, 287.70, 288.90, 292.32, 297.65, 307.43, 315.36, 320.51, 322.45, 323.29, 323.42, 323.47]
chT[37] = [  286.85, 287.66, 288.70, 291.78, 297.15, 307.41, 315.63, 320.67, 322.55, 323.54, 323.72, 323.79]
chT[38] = [  286.85, 287.65, 288.73, 291.94, 297.38, 307.58, 315.75, 320.82, 322.67, 323.60, 323.80, 323.88]
chT[39] = [  286.85, 287.75, 288.92, 292.35, 297.80, 307.92, 316.24, 321.48, 323.28, 324.07, 324.25, 324.32]

chR[1] = [  7.5214E+02, 7.5081E+02, 7.4850E+02, 7.4221E+02, 7.3226E+02, 7.1138E+02, 6.9276E+02, 6.8032E+02, 6.7452E+02, 6.7154E+02, 6.7131E+02, 6.7123E+02]
chR[2] = [  7.5214E+02, 7.5066E+02, 7.4831E+02, 7.4211E+02, 7.3207E+02, 7.1103E+02, 6.9270E+02, 6.8030E+02, 6.7469E+02, 6.7198E+02, 6.7168E+02, 6.7155E+02]
chR[3] = [  7.5214E+02, 7.5065E+02, 7.4835E+02, 7.4197E+02, 7.3149E+02, 7.1054E+02, 6.9243E+02, 6.7979E+02, 6.7434E+02, 6.7189E+02, 6.7159E+02, 6.7146E+02]
chR[19] = [ 7.5214E+02, 7.5073E+02, 7.4865E+02, 7.4250E+02, 7.3227E+02, 7.1118E+02, 6.9243E+02, 6.7993E+02, 6.7439E+02, 6.7138E+02, 6.7100E+02, 6.7088E+02]
chR[20] = [ 7.5214E+02, 7.5062E+02, 7.4848E+02, 7.4223E+02, 7.3188E+02, 7.1089E+02, 6.9244E+02, 6.7990E+02, 6.7454E+02, 6.7182E+02, 6.7140E+02, 6.7126E+02]
chR[21] = [ 7.5214E+02, 7.5056E+02, 7.4833E+02, 7.4183E+02, 7.3120E+02, 7.1035E+02, 6.9187E+02, 6.7885E+02, 6.7364E+02, 6.7131E+02, 6.7094E+02, 6.7080E+02]
chR[37] = [ 7.5214E+02, 7.5063E+02, 7.4870E+02, 7.4286E+02, 7.3219E+02, 7.1037E+02, 6.9120E+02, 6.7842E+02, 6.7335E+02, 6.7063E+02, 6.7011E+02, 6.6993E+02]
chR[38] = [ 7.5214E+02, 7.5066E+02, 7.4865E+02, 7.4256E+02, 7.3173E+02, 7.0999E+02, 6.9090E+02, 6.7801E+02, 6.7303E+02, 6.7046E+02, 6.6989E+02, 6.6967E+02]
chR[39] = [ 7.5214E+02, 7.5047E+02, 7.4829E+02, 7.4178E+02, 7.3089E+02, 7.0924E+02, 6.8968E+02, 6.7624E+02, 6.7136E+02, 6.6913E+02, 6.6861E+02, 6.6842E+02]


rod[1]  = [ 287.20, 288.04, 290.36, 293.83, 302.24, 311.92, 318.23, 321.23, 323.01, 323.24, 323.32]
rod[2]  = [ 287.22, 288.12, 290.40, 294.02, 302.52, 312.03, 318.31, 321.43, 322.98, 323.21, 323.30]
rod[18] = [ 287.25, 288.04, 290.15, 293.76, 302.46, 312.16, 318.67, 321.59, 323.16, 323.49, 323.60]
rod[19] = [ 287.26, 288.12, 290.28, 294.08, 302.72, 312.34, 318.90, 321.95, 323.31, 323.62, 323.75]

c = {}
c[1]  = [1, 2, 19, 20]
c[2]  = [2, 3, 20, 21]
c[18] = [19, 20, 37, 38]
c[19] = [20, 21, 38, 39]

for (Nr, Ncl) in c.items():
    print 'Compare for rod ', Nr
    r = rod[Nr][:]
    cT1 = chT[Ncl[0]][:]
    cT2 = chT[Ncl[1]][:]
    cT3 = chT[Ncl[2]][:]
    cT4 = chT[Ncl[3]][:]
    cR1 = chR[Ncl[0]][:]
    cR2 = chR[Ncl[1]][:]
    cR3 = chR[Ncl[2]][:]
    cR4 = chR[Ncl[3]][:]
    for i in range(len(r)):
        tr = r[i]
        k = i+1

        t1 = (cT1[i]*cR1[i] + cT1[k]*cR1[k])/(cR1[i]+cR1[k])
        t2 = (cT2[i]*cR2[i] + cT2[k]*cR2[k])/(cR2[i]+cR2[k])
        t3 = (cT3[i]*cR3[i] + cT3[k]*cR3[k])/(cR3[i]+cR3[k])
        t4 = (cT4[i]*cR4[i] + cT4[k]*cR4[k])/(cR4[i]+cR4[k])

        r1 = (cR1[i]+cR1[k])/2.
        r2 = (cR2[i]+cR2[k])/2.
        r3 = (cR3[i]+cR3[k])/2.
        r4 = (cR4[i]+cR4[k])/2.

        # tc = (c1[i] + c1[k] + c2[i] + c2[k] + c3[i] + c3[k] + c4[i] + c4[k]) / 8.
        tc = (t1*r1 + t2*r2 + t3*r3 + t4*r4)/(r1+r2+r3+r4)
        print '{:8.2f} {:8.2f} {:8.2f}'.format(tr, tc, tr-tc)
